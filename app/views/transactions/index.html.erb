<% content_for :title, "Transactions" %>

<div class="flex flex-col items-center pb-10">
  <h2 class="text-2xl font-bold mt-10 w-full max-w-240 px-4">Transactions</h2>

  <% if @transactions.any? %>
    <div class="w-full max-w-240 mt-4 space-y-6">
      <% @transactions.group_by(&:date).each do |date, transactions| %>
        <div>
          <h3 class="text-sm font-semibold text-base-content/60 px-4 mb-2">
            <% if date == Date.current %>
              Today
            <% elsif date == Date.yesterday %>
              Yesterday
            <% else %>
              <%= date&.strftime("%a, %b %-d") %>
            <% end %>
          </h3>

          <div class="card bg-base-100 shadow-glow">
            <div class="card-body p-0 gap-0 divide-y divide-base-300">
              <% transactions.each do |transaction| %>
                <%= render transaction %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% elsif !@has_bank %>
    <div class="card card-lg bg-base-100 mt-4 w-full max-w-240 shadow-glow">
      <div class="card-body">
        <div class="text-center py-8">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-base-content/40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
          </svg>

          <p class="mt-4 text-base-content/60">No bank account linked</p>

          <p class="mt-1 text-sm text-base-content/40">Link your bank account to start tracking transactions</p>

          <%= link_to "Link Account", settings_path, class: "btn btn-primary btn-sm mt-4" %>
        </div>
      </div>
    </div>
  <% else %>
    <div class="card card-lg bg-base-100 mt-4 w-full max-w-240 shadow-glow">
      <div class="card-body">
        <div class="text-center py-8">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-base-content/40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
          </svg>

          <p class="mt-4 text-base-content/60">No transactions yet</p>

          <p class="mt-1 text-sm text-base-content/40">Transactions will appear here once your bank syncs</p>
        </div>
      </div>
    </div>
  <% end %>
</div>
